# åˆ‡æ¢åˆ°çœŸå®åç«¯æŒ‡å—

## âœ… å·²å®Œæˆçš„å‡†å¤‡å·¥ä½œ

1. **Mockæ¨¡å¼å·²å…³é—­** - `utils/api.js` ä¸­ `USE_MOCK_DATA = false`
2. **æ‰€æœ‰åŠŸèƒ½å·²å®ç°** - ç»„é˜Ÿè¯¦æƒ…é¡µé¢æ”¹é€ å®Œæˆ
3. **åç«¯APIæ–‡æ¡£å·²å‡†å¤‡** - æŸ¥çœ‹ `backend-api-changes.md`

## ğŸ”§ åç«¯éœ€è¦å®ç°çš„API

### ä¼˜å…ˆçº§1 - å¿…é¡»å®ç°ï¼ˆæ ¸å¿ƒåŠŸèƒ½ï¼‰

1. **GET /api/teams/:teamId** - è·å–æŒ‡å®šç»„é˜Ÿè¯¦æƒ…
   - æ”¯æŒé€šè¿‡teamIdæŸ¥è¯¢
   - è¿”å›å®Œæ•´çš„teamå¯¹è±¡ï¼ŒåŒ…å«æ‰€æœ‰æˆå‘˜ä¿¡æ¯å’Œnoteå­—æ®µ

2. **PUT /api/teams/:teamId/members/:userId/note** - æ›´æ–°æˆå‘˜å¤‡æ³¨
   - åªå…è®¸ç”¨æˆ·ç¼–è¾‘è‡ªå·±çš„å¤‡æ³¨
   - noteå­—æ®µæœ€å¤§500å­—ç¬¦

### ä¼˜å…ˆçº§2 - æ•°æ®ç»“æ„å˜æ›´

3. **Memberå¯¹è±¡æ·»åŠ noteå­—æ®µ**
   - åœ¨æ‰€æœ‰è¿”å›Memberå¯¹è±¡çš„APIä¸­åŒ…å«noteå­—æ®µ
   - é»˜è®¤å€¼ï¼šç©ºå­—ç¬¦ä¸²
   - ç±»å‹ï¼šstring, optional

### ä¼˜å…ˆçº§3 - Bugä¿®å¤

4. **æ£€æŸ¥propertyIdå…³è”**
   - ç¡®ä¿åˆ›å»ºç»„é˜Ÿæ—¶propertyIdæ­£ç¡®ä¿å­˜
   - éªŒè¯ç°æœ‰æ•°æ®åº“ä¸­çš„propertyIdæ˜¯å¦å‡†ç¡®

## ğŸ“ è¯¦ç»†APIæ–‡æ¡£

å®Œæ•´çš„APIè§„èŒƒè¯·æŸ¥çœ‹ï¼š
- [backend-api-changes.md](file:///C:/Users/Markus725/.gemini/antigravity/brain/8f4b2a14-063d-4c4c-bd11-7cd7f27f61c6/backend-api-changes.md)

åŒ…å«ï¼š
- å®Œæ•´çš„è¯·æ±‚/å“åº”ç¤ºä¾‹
- é”™è¯¯å¤„ç†è§„èŒƒ
- æƒé™éªŒè¯è¦æ±‚
- æµ‹è¯•ç”¨ä¾‹

## ğŸ§ª å‰ç«¯æµ‹è¯•æ­¥éª¤

### 1. ç¡®è®¤Mockå·²å…³é—­

æ£€æŸ¥ `d:\Wechat_MiniPrograms\Nottingham\utils\api.js` ç¬¬5è¡Œï¼š
```javascript
const USE_MOCK_DATA = false  // âœ… åº”è¯¥æ˜¯false
```

### 2. ç¡®è®¤ç”¨æˆ·å·²ç™»å½•

- å°ç¨‹åºéœ€è¦æœ‰æ•ˆçš„ç™»å½•token
- å¯ä»¥åœ¨"æˆ‘çš„"é¡µé¢ç™»å½•

### 3. æµ‹è¯•æµç¨‹

**æµ‹è¯•1: æŸ¥çœ‹æˆ‘çš„ç»„é˜Ÿ**
1. è¿›å…¥"ç»„é˜Ÿ"é¡µé¢
2. åˆ‡æ¢åˆ°"æˆ‘çš„ç»„é˜Ÿ"tab
3. å¦‚æœæœ‰ç»„é˜Ÿï¼Œåº”æ˜¾ç¤ºåˆ—è¡¨
4. ç‚¹å‡»ç»„é˜Ÿå¡ç‰‡ï¼Œè¿›å…¥è¯¦æƒ…é¡µ

**æµ‹è¯•2: æŸ¥çœ‹ç»„é˜Ÿè¯¦æƒ…**
1. è¯¦æƒ…é¡µåº”æ˜¾ç¤ºï¼š
   - æˆ¿æºä¿¡æ¯
   - ç»„é˜Ÿè¯´æ˜
   - å‘èµ·äººä¿¡æ¯ï¼ˆå«ä¸ªäººå¤‡æ³¨ï¼‰
   - å®¤å‹åˆ—è¡¨ï¼ˆå«ä¸ªäººå¤‡æ³¨ï¼‰

**æµ‹è¯•3: ç¼–è¾‘ä¸ªäººå¤‡æ³¨**
1. æ‰¾åˆ°è‡ªå·±çš„å¤‡æ³¨åŒºåŸŸ
2. ç‚¹å‡»"ç¼–è¾‘"æŒ‰é’®
3. è¾“å…¥å¤‡æ³¨å†…å®¹
4. ç‚¹å‡»"ä¿å­˜"
5. åº”æ˜¾ç¤º"ä¿å­˜æˆåŠŸ"å¹¶åˆ·æ–°æ˜¾ç¤º

## âš ï¸ å¯èƒ½é‡åˆ°çš„é—®é¢˜

### é—®é¢˜1: æç¤º"ç»„é˜Ÿä¸å­˜åœ¨"

**åŸå› **: åç«¯getTeamDetail APIæœªå®ç°æˆ–è¿”å›null

**è§£å†³**: 
1. æ£€æŸ¥åç«¯APIæ˜¯å¦å·²å®ç°
2. æŸ¥çœ‹åç«¯æ—¥å¿—ï¼Œç¡®è®¤teamIdæ˜¯å¦æ­£ç¡®æ¥æ”¶
3. éªŒè¯æ•°æ®åº“ä¸­æ˜¯å¦æœ‰å¯¹åº”çš„teamè®°å½•

### é—®é¢˜2: å¤‡æ³¨ä¿å­˜å¤±è´¥

**åŸå› **: updateMemberNote APIæœªå®ç°æˆ–æƒé™éªŒè¯å¤±è´¥

**è§£å†³**:
1. æ£€æŸ¥APIæ˜¯å¦å·²å®ç°
2. ç¡®è®¤userIdä¸å½“å‰ç™»å½•ç”¨æˆ·IDä¸€è‡´
3. æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æ˜¯è¯¥ç»„é˜Ÿçš„æˆå‘˜

### é—®é¢˜3: æˆå‘˜åˆ—è¡¨ä¸­æ²¡æœ‰noteå­—æ®µ

**åŸå› **: åç«¯è¿”å›çš„Memberå¯¹è±¡ç¼ºå°‘noteå­—æ®µ

**è§£å†³**:
1. æ•°æ®åº“æ·»åŠ noteå­—æ®µ
2. åœ¨æŸ¥è¯¢æ—¶åŒ…å«noteå­—æ®µ
3. ç¡®ä¿æ‰€æœ‰ç›¸å…³APIéƒ½è¿”å›note

## ğŸ“Š å‰åç«¯æ•°æ®æµ

```
ç”¨æˆ·ç‚¹å‡»ç»„é˜Ÿå¡ç‰‡
  â†“
å‰ç«¯: navigateToDetail(teamId: 2)
  â†“
å‰ç«¯: wx.navigateTo('/pages/team-detail/team-detail?teamId=2')
  â†“
å‰ç«¯: team-detail onLoad(options)
  â†“
å‰ç«¯: api.getTeamDetail(2)
  â†“
åç«¯: GET /api/teams/2
  â†“
åç«¯: è¿”å›teamå¯¹è±¡ï¼ˆå«membersåŠnoteï¼‰
  â†“
å‰ç«¯: æ¸²æŸ“ç»„é˜Ÿè¯¦æƒ…é¡µé¢
```

```
ç”¨æˆ·ç¼–è¾‘å¤‡æ³¨
  â†“
å‰ç«¯: startEditNote(userId)
  â†“
ç”¨æˆ·è¾“å…¥å†…å®¹
  â†“
å‰ç«¯: saveNote()
  â†“
å‰ç«¯: api.updateMemberNote(teamId, userId, note)
  â†“
åç«¯: PUT /api/teams/:teamId/members/:userId/note
  â†“
åç«¯: éªŒè¯æƒé™ â†’ æ›´æ–°æ•°æ®åº“ â†’ è¿”å›
  â†“
å‰ç«¯: æ›´æ–°æœ¬åœ°teamæ•°æ®ï¼Œæ˜¾ç¤º"ä¿å­˜æˆåŠŸ"
```

## ğŸ¯ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

1. **åç«¯å¼€å‘** - æŒ‰ç…§backend-api-changes.mdå®ç°API
2. **æ•°æ®åº“è¿ç§»** - æ·»åŠ noteå­—æ®µ
3. **è”è°ƒæµ‹è¯•** - å‰åç«¯è”è°ƒéªŒè¯åŠŸèƒ½
4. **Bugä¿®å¤** - ä¿®å¤å‘ç°çš„é—®é¢˜
5. **ä¸Šçº¿éƒ¨ç½²** - éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·å‚è€ƒï¼š
- [backend-api-changes.md](file:///C:/Users/Markus725/.gemini/antigravity/brain/8f4b2a14-063d-4c4c-bd11-7cd7f27f61c6/backend-api-changes.md) - å®Œæ•´APIæ–‡æ¡£
- [walkthrough.md](file:///C:/Users/Markus725/.gemini/antigravity/brain/8f4b2a14-063d-4c4c-bd11-7cd7f27f61c6/walkthrough.md) - åŠŸèƒ½è¯´æ˜
