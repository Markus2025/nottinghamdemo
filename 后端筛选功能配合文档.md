# åç«¯é…åˆæ–‡æ¡£ - æˆ¿æºç­›é€‰åŠŸèƒ½

## ğŸ“‹ éœ€æ±‚æ¦‚è¿°

å‰ç«¯éœ€è¦å®ç°3ä¸ªç­›é€‰åŠŸèƒ½ï¼š
1. âœ… ä»·æ ¼èŒƒå›´ç­›é€‰
2. âœ… æˆ·å‹ç­›é€‰ï¼ˆ1-6å±…å®¤ï¼‰
3. âœ… ä½ç½®ç­›é€‰ï¼ˆ7ä¸ªå›ºå®šåŒºåŸŸï¼‰

**ç›®æ ‡**ï¼šç¡®ä¿åå°ç®¡ç†ç³»ç»Ÿä½¿ç”¨å›ºå®šé€‰é¡¹ï¼Œé¿å…è¾“å…¥é”™è¯¯

---

## ğŸ—„ï¸ æ•°æ®åº“ä¿®æ”¹

### è¡¨ï¼š`properties`

#### éœ€è¦ä¿®æ”¹çš„å­—æ®µ

| å­—æ®µå | ç±»å‹ | çº¦æŸ | ä¿®æ”¹è¯´æ˜ |
|--------|------|------|----------|
| `bedrooms` | INTEGER | NOT NULL, CHECK (bedrooms BETWEEN 1 AND 6) | âœ… é™åˆ¶ä¸º1-6 |
| `location` | VARCHAR(50) | NOT NULL | âœ… ä½¿ç”¨æšä¸¾æˆ–çº¦æŸ |
| `price` | DECIMAL(10,2) | NOT NULL, CHECK (price >= 0) | âœ… ç”¨äºä»·æ ¼ç­›é€‰ |

#### SQLä¿®æ”¹è¯­å¥

**MySQL/MariaDB**ï¼š
```sql
-- ä¿®æ”¹bedroomså­—æ®µ
ALTER TABLE properties 
MODIFY COLUMN bedrooms INT NOT NULL 
CHECK (bedrooms BETWEEN 1 AND 6);

-- ä¿®æ”¹locationå­—æ®µï¼ˆä½¿ç”¨ENUMï¼‰
ALTER TABLE properties 
MODIFY COLUMN location ENUM(
  'Lenton', 
  'Beeston', 
  'Wollaton', 
  'Dunkirk', 
  'City Centre', 
  'Arboretum', 
  'Radford'
) NOT NULL;
```

**PostgreSQL**ï¼š
```sql
-- åˆ›å»ºç±»å‹
CREATE TYPE location_type AS ENUM (
  'Lenton', 
  'Beeston', 
  'Wollaton', 
  'Dunkirk', 
  'City Centre', 
  'Arboretum', 
  'Radford'
);

-- ä¿®æ”¹å­—æ®µ
ALTER TABLE properties 
ALTER COLUMN location TYPE location_type 
USING location::location_type;

-- æ·»åŠ bedroomsçº¦æŸ
ALTER TABLE properties 
ADD CONSTRAINT bedrooms_range 
CHECK (bedrooms >= 1 AND bedrooms <= 6);
```

---

## ğŸ”Œ APIä¿®æ”¹

### GET /api/properties

#### å½“å‰å®ç°ï¼ˆæ¨æµ‹ï¼‰

```javascript
router.get('/properties', async (req, res) => {
  const { page = 1, limit = 10 } = req.query
  
  const properties = await Property.findAll({
    limit: parseInt(limit),
    offset: (parseInt(page) - 1) * parseInt(limit),
    where: { status: 'active' }
  })
  
  res.json({ list: properties, total: properties.length })
})
```

#### éœ€è¦ä¿®æ”¹ä¸º

```javascript
router.get('/properties', async (req, res) => {
  const { 
    page = 1, 
    limit = 10,
    minPrice,    // âœ… æ–°å¢
    maxPrice,    // âœ… æ–°å¢
    bedrooms,    // âœ… æ–°å¢
    location     // âœ… æ–°å¢
  } = req.query
  
  // æ„å»ºæŸ¥è¯¢æ¡ä»¶
  let where = { status: 'active' }
  
  // âœ… ä»·æ ¼ç­›é€‰
  if (minPrice !== undefined || maxPrice !== undefined) {
    where.price = {}
    if (minPrice) where.price.$gte = parseFloat(minPrice)
    if (maxPrice) where.price.$lte = parseFloat(maxPrice)
  }
  
  // âœ… æˆ·å‹ç­›é€‰
  if (bedrooms) {
    where.bedrooms = parseInt(bedrooms)
  }
  
  // âœ… ä½ç½®ç­›é€‰
  if (location) {
    where.location = location
  }
  
  // æŸ¥è¯¢
  const properties = await Property.findAll({
    where,
    limit: parseInt(limit),
    offset: (parseInt(page) - 1) * parseInt(limit),
    order: [['createdAt', 'DESC']]
  })
  
  // è·å–æ€»æ•°
  const total = await Property.count({ where })
  
  res.json({ 
    list: properties, 
    total,
    limit: parseInt(limit)
  })
})
```

#### APIæµ‹è¯•ç”¨ä¾‹

```bash
# ä»·æ ¼ç­›é€‰
GET /api/properties?minPrice=500&maxPrice=1500

# æˆ·å‹ç­›é€‰
GET /api/properties?bedrooms=2

# ä½ç½®ç­›é€‰
GET /api/properties?location=Lenton

# ç»„åˆç­›é€‰
GET /api/properties?minPrice=800&maxPrice=1200&bedrooms=3&location=Beeston
```

---

## ğŸ–¥ï¸ åå°ç®¡ç†ç³»ç»Ÿä¿®æ”¹

### 1. æ·»åŠ æˆ¿æºè¡¨å•ï¼ˆHTMLï¼‰

#### ä¿®æ”¹å‰ï¼ˆæ–‡æœ¬è¾“å…¥ï¼‰

```html
<div class="form-group">
  <label>æˆ·å‹</label>
  <input type="text" name="bedrooms" placeholder="è¯·è¾“å…¥æˆ·å‹"> âŒ
</div>

<div class="form-group">
  <label>ä½ç½®</label>
  <input type="text" name="location" placeholder="è¯·è¾“å…¥ä½ç½®"> âŒ
</div>
```

#### ä¿®æ”¹åï¼ˆä¸‹æ‹‰é€‰æ‹©ï¼‰

```html
<!-- æˆ·å‹é€‰æ‹© -->
<div class="form-group">
  <label>æˆ·å‹ <span class="required">*</span></label>
  <select name="bedrooms" required>
    <option value="">è¯·é€‰æ‹©æˆ·å‹</option>
    <option value="1">1å±…å®¤</option>
    <option value="2">2å±…å®¤</option>
    <option value="3">3å±…å®¤</option>
    <option value="4">4å±…å®¤</option>
    <option value="5">5å±…å®¤</option>
    <option value="6">6å±…å®¤</option>
  </select>
</div>

<!-- ä½ç½®é€‰æ‹© -->
<div class="form-group">
  <label>ä½ç½® <span class="required">*</span></label>
  <select name="location" required>
    <option value="">è¯·é€‰æ‹©ä½ç½®</option>
    <option value="Lenton">Lenton</option>
    <option value="Beeston">Beeston</option>
    <option value="Wollaton">Wollaton</option>
    <option value="Dunkirk">Dunkirk</option>
    <option value="City Centre">City Centre</option>
    <option value="Arboretum">Arboretum</option>
    <option value="Radford">Radford</option>
  </select>
</div>
```

### 2. ç¼–è¾‘æˆ¿æºè¡¨å•

ç¡®ä¿ç¼–è¾‘æ—¶ä¹Ÿä½¿ç”¨ä¸‹æ‹‰é€‰æ‹©ï¼Œå¹¶é¢„é€‰å½“å‰å€¼ï¼š

```html
<select name="bedrooms" required>
  <option value="1" <%= property.bedrooms === 1 ? 'selected' : '' %>>1å±…å®¤</option>
  <option value="2" <%= property.bedrooms === 2 ? 'selected' : '' %>>2å±…å®¤</option>
  <!-- ... -->
</select>

<select name="location" required>
  <option value="Lenton" <%= property.location === 'Lenton' ? 'selected' : '' %>>Lenton</option>
  <!-- ... -->
</select>
```

### 3. è¡¨å•éªŒè¯ï¼ˆåç«¯ï¼‰

```javascript
// POST /admin/properties
router.post('/properties', async (req, res) => {
  const { bedrooms, location, price } = req.body
  
  // âœ… éªŒè¯æˆ·å‹
  if (!bedrooms || bedrooms < 1 || bedrooms > 6) {
    return res.status(400).json({ error: 'æˆ·å‹å¿…é¡»åœ¨1-6ä¹‹é—´' })
  }
  
  // âœ… éªŒè¯ä½ç½®
  const validLocations = [
    'Lenton', 'Beeston', 'Wollaton', 'Dunkirk', 
    'City Centre', 'Arboretum', 'Radford'
  ]
  if (!validLocations.includes(location)) {
    return res.status(400).json({ error: 'ä½ç½®æ— æ•ˆ' })
  }
  
  // âœ… éªŒè¯ä»·æ ¼
  if (!price || price < 0) {
    return res.status(400).json({ error: 'ä»·æ ¼å¿…é¡»å¤§äº0' })
  }
  
  // åˆ›å»ºæˆ¿æº...
})
```

---

## ğŸ“‹ å®Œæ•´çš„å›ºå®šå€¼åˆ—è¡¨

### æˆ·å‹ï¼ˆBedroomsï¼‰

```javascript
const BEDROOMS_OPTIONS = [1, 2, 3, 4, 5, 6]
```

### ä½ç½®ï¼ˆLocationï¼‰

```javascript
const LOCATION_OPTIONS = [
  'Lenton',
  'Beeston',
  'Wollaton',
  'Dunkirk',
  'City Centre',
  'Arboretum',
  'Radford'
]
```

å»ºè®®åœ¨åç«¯åˆ›å»ºå¸¸é‡æ–‡ä»¶ï¼š

```javascript
// constants/propertyConstants.js
module.exports = {
  BEDROOMS_OPTIONS: [1, 2, 3, 4, 5, 6],
  LOCATION_OPTIONS: [
    'Lenton',
    'Beeston',
    'Wollaton',
    'Dunkirk',
    'City Centre',
    'Arboretum',
    'Radford'
  ]
}
```

---

## âœ… éªŒè¯æ­¥éª¤

### 1. æ•°æ®åº“éªŒè¯

```sql
-- æ£€æŸ¥bedroomsèŒƒå›´
SELECT * FROM properties WHERE bedrooms < 1 OR bedrooms > 6;
-- åº”è¯¥è¿”å›ç©ºç»“æœ

-- æ£€æŸ¥locationå€¼
SELECT DISTINCT location FROM properties;
-- åº”è¯¥åªè¿”å›7ä¸ªå›ºå®šå€¼
```

### 2. APIæµ‹è¯•

```bash
# æµ‹è¯•ä»·æ ¼ç­›é€‰
curl "http://localhost:3000/api/properties?minPrice=500&maxPrice=1000"

# æµ‹è¯•æˆ·å‹ç­›é€‰
curl "http://localhost:3000/api/properties?bedrooms=2"

# æµ‹è¯•ä½ç½®ç­›é€‰
curl "http://localhost:3000/api/properties?location=Lenton"
```

### 3. åå°ç®¡ç†æµ‹è¯•

- [ ] æ·»åŠ æˆ¿æºæ—¶ï¼Œæˆ·å‹å’Œä½ç½®éƒ½æ˜¯ä¸‹æ‹‰é€‰æ‹©
- [ ] æ— æ³•è¾“å…¥å…¶ä»–å€¼
- [ ] ç¼–è¾‘æ—¶æ­£ç¡®æ˜¾ç¤ºå½“å‰å€¼
- [ ] ä¿å­˜åæ•°æ®æ­£ç¡®

---

## ğŸ¯ æ€»ç»“

**éœ€è¦ä¿®æ”¹çš„éƒ¨åˆ†**ï¼š

1. âœ… æ•°æ®åº“ï¼šæ·»åŠ çº¦æŸï¼Œé™åˆ¶bedroomså’Œlocationçš„å€¼
2. âœ… APIï¼šæ”¯æŒminPrice, maxPrice, bedrooms, locationå‚æ•°
3. âœ… åå°ç®¡ç†ï¼šæˆ·å‹å’Œä½ç½®æ”¹ä¸ºä¸‹æ‹‰é€‰æ‹©
4. âœ… éªŒè¯ï¼šç¡®ä¿æ— æ³•è¾“å…¥éæ³•å€¼

å®Œæˆè¿™äº›ä¿®æ”¹åï¼Œå‰ç«¯çš„ç­›é€‰åŠŸèƒ½å°†å®Œå…¨ç”Ÿæ•ˆï¼
